# 变量

变量类型、赋值方式与作用域。
## 变量类型

Makefile 中的变量主要分为以下几种类型：

- **简单变量（Simple Variables）**：使用 `=` 进行赋值，变量的值在引用时才会展开。
- **递归变量（Recursive Variables）**：同样使用 `=`，但允许变量引用自身，形成递归展开。
- **立即变量（Simply Expanded Variables）**：使用 `:=` 进行赋值，变量的值在定义时立即展开。
- **追加变量（Appending Variables）**：使用 `+=` 在现有变量基础上追加值。
- **条件赋值变量（Conditional Variables）**：使用 `?=` 仅在变量未定义时赋值。

## 赋值方式

- `VAR = value`：简单赋值，延迟展开。
- `VAR := value`：立即赋值，定义时展开。
- `VAR += value`：追加赋值，如果变量未定义则等同于 `VAR = value`。
- `VAR ?= value`：条件赋值，仅在变量未定义时生效。

## 作用域

- **全局作用域**：在整个 Makefile 中有效，除非被局部覆盖。
- **局部作用域**：在特定规则或函数中定义，仅在该范围内有效。
- **环境变量**：Makefile 可以继承 shell 环境变量，也可以通过 `export` 导出给子进程。

## 注意事项

- **空格敏感**：变量名和赋值符之间不能有空格，否则会被误解为命令。
- **展开时机**：使用 `=` 的变量在引用时展开，可能导致意外的递归；使用 `:=` 避免此问题。
- **引用方式**：使用 `$(VAR)` 或 `${VAR}` 来引用变量值。
- **转义字符**：在变量值中需要转义特殊字符，如 `$` 用 `$$` 表示。
- **覆盖问题**：命令行参数可以覆盖 Makefile 中的变量定义，使用 `-e` 选项强制使用环境变量。
- **性能考虑**：大量使用递归变量可能影响 Makefile 的解析速度，优先使用立即变量。
- **调试技巧**：使用 `make -p` 查看所有变量的值，或在 Makefile 中添加 `$(info $(VAR))` 来打印变量。
